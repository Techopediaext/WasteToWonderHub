<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Waste To Wonder Hub</title>
  <!-- Inline CSS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script src="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.js"></script>
  <link rel="stylesheet" href="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.css" />

  <style>
    :root{
      --bg:#f4f9f6; --ink:#1b4332; --muted:#2e7d32; --accent:#43a047; --card:#ffffff; --shadow:0 10px 20px rgba(0,0,0,.08);
    }
    *{box-sizing:border-box}
    html,body{margin:0;padding:0;background:var(--bg);color:var(--ink);font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif}
	  
	.header-container {display: flex;align-items: center;justify-content: center;position: relative;}
	  
	@media (max-width: 600px) {
		.header-container {flex-direction: column; align-items: center;}
		.site-logo {position: static;transform: none;margin-bottom: 10px;
					max-width: 100px; /* smaller on mobile */
				   }
		.header-text {text-align: center;}
	}
	.site-logo {position: absolute;left: 16px;top: 50%;transform: translateY(-50%);max-width: 120px;height: auto;filter: drop-shadow(0 2px 4px rgba(0,0,0,0.15));}

	.header-text {text-align: center;}
    header{padding:28px 16px;background:linear-gradient(135deg,var(--muted),#1e5631);color:#fff;text-align:center}
    header h1{margin:0 0 6px;font-size:clamp(24px,3.2vw,36px);letter-spacing:.3px}
    header p{margin:0;opacity:.95}

    nav{position:sticky;top:0;z-index:20;display:flex;gap:8px;flex-wrap:wrap;justify-content:center;padding:10px;background:#388e3c}
    nav button{appearance:none;border:0;background:transparent;color:#fff;padding:10px 14px;border-radius:999px;cursor:pointer;font-weight:600}
    nav button.active,nav button:hover{background:rgba(255,255,255,.15)}

    main{padding:22px;max-width:1200px;margin-inline:auto}
    section{display:none;animation:fade .25s ease}
    section.active{display:block}
    @keyframes fade{from{opacity:.6;transform:translateY(3px)}to{opacity:1;transform:none}}

    .card-grid{display:grid;gap:18px;grid-template-columns:repeat(auto-fit,minmax(220px,1fr))}
    .card{background:var(--card);border-radius:16px;box-shadow:var(--shadow);padding:18px;cursor:pointer;transition:.2s transform,.2s box-shadow}
    .card:hover{transform:translateY(-2px);box-shadow:0 16px 30px rgba(0,0,0,.12)}

    .btn{appearance:none;border:0;border-radius:10px;background:var(--accent);color:#fff;padding:10px 14px;cursor:pointer;font-weight:700}
    .btn[disabled]{opacity:.6;cursor:not-allowed}

    .stack{display:flex;gap:12px;flex-wrap:wrap;align-items:center}
    .muted{opacity:.8}
    .pill{display:inline-flex;align-items:center;gap:8px;background:#e8f5e9;color:#1b5e20;border-radius:999px;padding:6px 10px;font-weight:600}

    /* AI Assist */
    .ai-wrap{display:grid;gap:16px;grid-template-columns:1fr;max-width:820px}
    .ai-panel{background:var(--card);border-radius:16px;box-shadow:var(--shadow);padding:16px}
    .ai-preview{max-width:240px;border-radius:12px;border:2px solid #dfe7e3;display:none}
    .mono{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;background:#0b2e13;color:#c8facc;border-radius:10px;padding:10px;white-space:pre-wrap}

    /* Modal */
    .modal{display:none;position:fixed;inset:0;background:rgba(0,0,0,.6);align-items:center;justify-content:center}
    .modal.open{display:flex}
    .modal .box{width:min(800px,92vw);max-height:80vh;overflow:auto;background:#fff;border-radius:16px;box-shadow:var(--shadow);padding:18px}
    .modal .close{float:right;font-size:22px;cursor:pointer}
	
	    /* Recycle Center */
    #map { width:100%; height:500px; border-radius:12px; margin-bottom:1rem; }
    #centerList { list-style:none; padding:0; margin:0; }
    #centerList li { background:white; margin:.5rem 0; padding:.8rem; border-radius:8px; display:flex; align-items:center; justify-content:space-between; box-shadow:0 2px 4px rgba(0,0,0,0.1); cursor:pointer; }
    #centerList li:hover { background:#e8f5e9; }
    .center-info { display:flex; align-items:center; gap:.5rem; }
    .icon { font-size:1.2rem; color:#2e7d32; }
    .badge { background:#c8e6c9; color:#1b5e20; padding:2px 6px; border-radius:12px; font-size:.8rem; margin-left:.5rem; }

    footer{margin-top:28px;background:#2e7d32;color:#fff;text-align:center;padding:14px}
	
	/* Game styling */
#game-area { margin-top:20px; }
.horizontal { display:flex; gap:20px; justify-content:center; margin-bottom:20px; flex-wrap:wrap; }
.item { font-size:2rem; cursor:grab; background:white; padding:10px; border-radius:10px; box-shadow:0 2px 4px rgba(0,0,0,0.1); }
.bin {
  min-width: 100px;
  min-height: 100px;
  border-radius: 10px;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  font-weight: bold;
  padding: 10px;
  color: white;
}

/* Bin-specific colors */
#organic { background: #8B4513; }   /* Brown */
#paper { background: #1565C0; }     /* Blue */
#plastic { background: #FFD600; color: black; } /* Yellow */
#metal { background: #616161; }     /* Gray */
#general { background: #212121; }   /* Black */

.bin.correct { outline: 3px solid #4CAF50; }
.bin.wrong { outline: 3px solid #E53935; }


  </style>
  <!-- TensorFlow.js + backends + MobileNet -->
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@4.18.0/dist/tf.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-backend-wasm@4.18.0/dist/tf-backend-wasm.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/mobilenet@2.1.0"></script>
</head>
<body>
  <header>
	<div class="header-container">
    <img src="logo.jpg" 
         alt="Waste To Wonder Hub Logo" 
         class="site-logo" />
    <div class="header-text">
    <h1>Waste To Wonder Hub</h1>
    <p>Transforming Waste into Opportunities for a Sustainable Future</p>
	</div>
  </div>
  </header>

  <nav id="tabs">
    <button data-tab="home" class="active">Home</button>
    <button data-tab="ai">AI Assistance</button>
    <button data-tab="ideas">Ideas</button>
    <button data-tab="tutorials">Tutorials</button>
    <button data-tab="quiz">Quiz</button>
    <button data-tab="game">Game</button>
    <button data-tab="recycle">Recycle Center</button>
  </nav>

  <main>
    <!-- Home -->
    <section id="home" class="active">
      <h2>Welcome to Waste To Wonder Hub</h2>
      <p class="muted">Explore tools and ideas to turn everyday waste into wonders. Click a card to begin.</p>
      <div class="card-grid">
        <div class="card" data-jump="ai"><strong>ü§ñ AI Assistance</strong><br/><span class="muted">Get suggestions from an image of waste.</span></div>
        <div class="card" data-jump="ideas"><strong>üí° Ideas</strong><br/><span class="muted">Upcycling ideas.</span></div>
        <div class="card" data-jump="tutorials"><strong>üìö Tutorials</strong><br/><span class="muted">Step-by-step guides & videos.</span></div>
        <div class="card" data-jump="quiz"><strong>üß† Quiz</strong><br/><span class="muted">Test your recycling IQ.</span></div>
        <div class="card" data-jump="game"><strong>üéØ Game</strong><br/><span class="muted">Drag & drop sorting.</span></div>
        <div class="card" data-jump="recycle"><strong>üìç Recycle Center</strong><br/><span class="muted">Find places to drop off.</span></div>
      </div>
    </section>

    <!-- AI Assistance -->
    <section id="ai">
      <h2>AI Assistance</h2>
      <p class="muted">Upload an image of a waste item; TensorFlow.js will recognize it and suggest recycling or upcycling ideas.</p>

      <div class="ai-wrap">
        <div class="ai-panel">
          <div class="stack">
            <input type="file" id="imageUpload" accept="image/*" />
            <button class="btn" id="analyzeBtn" disabled>Analyze Image</button>
            <span id="modelStatus" class="muted">Preparing TensorFlow‚Ä¶</span>
          </div>
          <img id="preview" class="ai-preview" alt="Preview" crossorigin="anonymous" />
          <div id="aiResult" class="ai-panel" style="margin-top:12px"></div>
        </div>

       <!-- <details class="ai-panel" open>
          <summary><strong>Diagnostics & Tests</strong></summary>
          <div id="diag" class="mono">Initialising‚Ä¶</div>
        </details>-->
      </div>
    </section>

    <!-- Ideas -->
    <section id="ideas">
      <h2>Recycling Ideas</h2>
      <p class="muted">Creative ways to transform common materials.</p>
      <div class="card-grid" id="ideasGrid"></div>
    </section>

    <!-- Tutorials (sample content kept minimal for brevity) -->
    <section id="tutorials">
      <h2>Tutorials</h2>
      <div class="card-grid">
       <!-- <div class="card" data-video="https://www.youtube.com/embed/aqz-KE-bpKQ">üåø Composting at Home (Video)old</div>-->
		<div class="card" data-video="https://www.youtube.com/embed/qHerkpmK1YQ">üåø Composting at Home (Video)</div>
        <div class="card" data-modal-title="Plastic Bottle Planter" data-modal-body="Cut, paint, and plant herbs or flowers in the bottle base.">üå± Plastic Bottle Planter</div>
        <div class="card" data-modal-title="DIY Paper Recycling" data-modal-body="Shred, soak, blend to pulp; spread and dry.">üìÑ DIY Paper Recycling</div>
        <div class="card" data-modal-title="Tin Can Lanterns" data-modal-body="Clean, punch patterns, add candle or LED.">üïØÔ∏è Tin Can Lanterns</div>
		<div class="card" data-video="https://www.youtube.com/embed/7yV6V6rtpyc">üê¶ DIY Bird Feeder (Video)</div>
		<div class="card" data-video="https://www.youtube.com/embed/fmcCbOz1BJw">üèÆ DIY Glass Jar Lantern (Video)</div>
		<div class="card" data-modal-title="DIY Newspaper Gift Bag" data-modal-body="1. Fold 2 sheets of newspaper into a rectangle.<br>2. Glue the sides to form a bag shape.<br>
			3. Fold and glue the bottom to make the base.<br>4. Punch 2 holes at the top on each side.<br>5. Thread ribbon or string through for handles.<br>
			6. Decorate if you like.">üì∞üéÅ DIY Newspaper Gift Bag</div>
		<div class="card" data-modal-title="DIY Pillow Cover" data-modal-body="1. Cut the sweater to fit your pillow.<br>2. Turn inside out and stitch 3 sides.<br>
			3. Insert the pillow.<br>4. Stitch or glue the last side closed.">üß∂ DIY Pillow Cover</div>
		<div class="card" data-video="https://www.youtube.com/embed/So8i2hYv4eY">üè∑Ô∏è DIY Bookmarks (Video)</div>
		<div class="card" data-video="https://www.youtube.com/embed/pPL8GyNX3Bw">üçæüé∂ DIY Wind Chimes (Video)</div>
		<div class="card" data-video="https://www.youtube.com/embed/D2KvSiN0uAQ&t=3s">üñäÔ∏èüìè DIY Desk Organiser (Video)</div>
		  
      </div>
    </section>

    <!-- Placeholders -->
    <section id="quiz">
  <h2>Recycling Quiz</h2>
  <p class="muted">Test your knowledge about recycling and sustainability!</p>
  <div id="quiz-container">
    <button id="startQuiz" class="btn">Start Quiz</button>
  </div>
</section>



    <section id="game">
  <h2>Recycling Sorting Game</h2>
  <p class="muted">Drag the items into the correct recycling bins!</p>

  <div id="game-area">
    <div id="items" class="horizontal"></div>
    <div id="bins" class="horizontal"></div>
  </div>

  <p id="game-score">Score: 0</p>
</section>

 <section id="recycle">
      <h2>Recycle Center</h2>
      <p class="muted">Find nearby recycling centers on the interactive map below.</p>
      <div id="map"></div>
      <h3>Nearest Centers:</h3>
      <ul id="centerList"></ul>
    </section>
  </main>

  <!-- Modal -->
  <div id="modal" class="modal" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="box">
      <span class="close" id="closeModal">&times;</span>
      <div id="modalBody"></div>
    </div>
  </div>

  <footer>
    <p>Aligned with United Nations Sustainable Development Goal 12: Responsible Consumption and Production</p>
  </footer>

  <!-- Inline JS -->
  <script>
  /* -------------------- Tabs -------------------- */
  const tabsEl = document.getElementById('tabs');
  const sections = [...document.querySelectorAll('main section')];
  tabsEl.addEventListener('click', (e)=>{
    if(e.target.matches('button[data-tab]')){
      const id = e.target.getAttribute('data-tab');
      document.querySelectorAll('nav button').forEach(b=>b.classList.toggle('active', b===e.target));
      sections.forEach(s=>s.classList.toggle('active', s.id===id));
	  if (id === "recycle") {
			setTimeout(() => {
			map.invalidateSize();
		}, 200);
	  }
    }
  });
  // Home cards jump
  document.querySelectorAll('[data-jump]').forEach(c=>c.addEventListener('click',()=>{
    const id=c.getAttribute('data-jump');
    document.querySelector(`nav button[data-tab="${id}"]`).click();
  }));

  /* -------------------- Modal helpers -------------------- */
  const modal = document.getElementById('modal');
  const modalBody = document.getElementById('modalBody');
  document.getElementById('closeModal').onclick=()=>{modal.classList.remove('open');modal.setAttribute('aria-hidden','true');modalBody.innerHTML=''};
  modal.addEventListener('click',(e)=>{ if(e.target===modal) document.getElementById('closeModal').click(); });
  document.querySelectorAll('#tutorials .card').forEach(card=>{
    const video = card.getAttribute('data-video');
    const title = card.getAttribute('data-modal-title');
    const body = card.getAttribute('data-modal-body');
    card.addEventListener('click',()=>{
      if(video){ modalBody.innerHTML = `<div style="position:relative;padding-top:56.25%"><iframe title="Tutorial" src="${video}" allowfullscreen style="position:absolute;inset:0;width:100%;height:100%;border:0"></iframe></div>`; }
      else { modalBody.innerHTML = `<h3>${title}</h3><p>${body}</p>`; }
      modal.classList.add('open'); modal.setAttribute('aria-hidden','false');
    });
  });

  /* -------------------- Ideas seed -------------------- */
  const IDEAS = [
  {title:'Plastic Bottle ‚Üí Planter', img:'', text:'Cut & paint bottles to grow herbs; add drainage holes.'},
  {title:'Cardboard ‚Üí Organizer', img:'', text:'Craft drawer dividers and desk caddies from sturdy boxes.'},
  {title:'Tin Can ‚Üí Lantern', img:'', text:'Punch patterns, add LED tealight for safe ambiance.'},
  {title:'Glass Jar ‚Üí Storage', img:'', text:'Label and reuse jars for pantry staples or screws.'},
  {title:'Old T-Shirt ‚Üí Tote', img:'', text:'Cut sleeves, stitch bottom: instant reusable bag.'},
  {title:'Newspaper ‚Üí Seed Pots', img:'', text:'Roll around a cup, fold base; plant and compost directly.'},
  {title:'Wine Corks ‚Üí Pin Board', img:'', text:'Glue corks into a frame to create a pin or trivet board.'},
  {title:'CDs/DVDs ‚Üí Mosaic Art', img:'', text:'Break and arrange old discs into shiny mosaic designs.'},
  {title:'Plastic Bags ‚Üí Plarn', img:'', text:'Cut into strips to crochet mats, bags, or coasters.'},
  {title:'Shoebox ‚Üí Charging Station', img:'', text:'Cut holes for wires; decorate to hide messy chargers.'},
  {title:'Old Jeans ‚Üí Pouch', img:'', text:'Sew denim scraps into coin purses or pencil cases.'},
  {title:'Mason Jar ‚Üí Herb Garden', img:'', text:'Grow small herbs indoors by placing jars on windowsills.'},
  {title:'Egg Carton ‚Üí Seed Starter', img:'', text:'Fill with soil, plant seeds; later transfer to garden.'},
  {title:'Broken Tiles ‚Üí Garden Path', img:'', text:'Arrange and set broken tiles to make stepping stones.'},
  {title:'Plastic Spoons ‚Üí Wall Art', img:'', text:'Paint and glue spoons into flower patterns for d√©cor.'},
  {title:'Glass Bottle ‚Üí Lamp', img:'', text:'Insert fairy lights inside for a glowing night lamp.'},
  {title:'Cereal Box ‚Üí Magazine Holder', img:'', text:'Cut diagonally, decorate, and store papers or books.'},
  {title:'Toilet Roll ‚Üí Cable Holder', img:'', text:'Use tubes to keep cables organized and tangle-free.'},
  {title:'Old Ladder ‚Üí Bookshelf', img:'', text:'Stand it against a wall and use steps as storage shelves.'},
  {title:'Tin Lid ‚Üí Coaster', img:'', text:'Decorate jar lids and use as reusable coasters.'},
  {title:'Plastic Jar ‚Üí Bird Feeder', img:'', text:'Hang outside with seeds for backyard birds.'},
  {title:'Old Sweater ‚Üí Cushion Cover', img:'', text:'Sew into cozy pillow covers for couches or beds.'},
  {title:'Glass Wine Bottle ‚Üí Vase', img:'', text:'Remove labels, decorate, and add fresh flowers.'},
  {title:'Broken Umbrella ‚Üí Tote', img:'', text:'Repurpose waterproof fabric into shopping bags.'},
  {title:'Metal Can ‚Üí Cutlery Holder', img:'', text:'Paint & decorate cans for organizing spoons and forks.'},
  {title:'Plastic Bottle Caps ‚Üí Art', img:'', text:'Glue together to make colorful wall decorations.'},
  {title:'Old Drawer ‚Üí Planter Box', img:'', text:'Line with soil to grow flowers or veggies.'},
  {title:'Jar ‚Üí Candle Holder', img:'', text:'Fill with wax & wick for homemade candles.'},
  {title:'Wooden Pallet ‚Üí Furniture', img:'', text:'Turn into a rustic coffee table or garden bench.'},
  {title:'Old Tires ‚Üí Garden Seat', img:'', text:'Paint, stack, and add cushion for outdoor seating.'}
  ];
  const ideasGrid = document.getElementById('ideasGrid');
  IDEAS.forEach(i=>{
    const el=document.createElement('div');
    el.className='card';
    el.innerHTML=`<strong>${i.title}</strong><p class="muted" style="margin:.4rem 0 0">${i.text}</p>`;
    ideasGrid.appendChild(el);
  });

  /* -------------------- AI Assistance (Pure TensorFlow.js) -------------------- */
  const imageInput = document.getElementById('imageUpload');
  const previewImg  = document.getElementById('preview');
  const analyzeBtn  = document.getElementById('analyzeBtn');
  const resultBox   = document.getElementById('aiResult');
  const statusEl    = document.getElementById('modelStatus');
 // const diagEl      = document.getElementById('diag');

  let aiModel = null; // MobileNet instance
  let modelReady = false;

  // Choose best backend and load the model once
  const modelLoadPromise = (async () => {
    try{
      // Prefer WebGL; fallback to WASM; finally CPU
      try {
        await tf.setBackend('webgl');
      } catch(_) {}
      if (tf.getBackend() !== 'webgl') {
        try {
          // set WASM paths hosted by jsDelivr CDN
          tf.wasm?.setWasmPaths?.('https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-backend-wasm@4.18.0/dist/');
          await tf.setBackend('wasm');
        } catch(_) {}
      }
      await tf.ready();
      statusEl.textContent = `TensorFlow backend: ${tf.getBackend()}`;

      aiModel = await mobilenet.load({version:2, alpha:1.0});

      // Warm up once to avoid first-inference delay
      const cvs = document.createElement('canvas');
      cvs.width = 224; cvs.height = 224;
      const ctx = cvs.getContext('2d');
      ctx.fillStyle = '#000'; ctx.fillRect(0,0,224,224);
      try{ await aiModel.classify(cvs); }catch(_){}

      modelReady = true;
      statusEl.textContent = `TensorFlow ready ‚Ä¢ backend: ${tf.getBackend()} ‚Ä¢ model: MobileNetV2`;
      analyzeBtn.disabled = false;
    }catch(err){
      console.error('Model init failed:', err);
      statusEl.textContent = 'TensorFlow init failed. Please check network and try again.';
      analyzeBtn.disabled = false; // allow manual retry/fallback
    }
  })();

  // Show preview when a file is chosen
  imageInput.addEventListener('change', (e)=>{
    const file = e.target.files && e.target.files[0];
    if(!file){ return; }
    const reader = new FileReader();
    reader.onload = () => {
      previewImg.src = reader.result;
      previewImg.style.display = 'block';
    };
    reader.readAsDataURL(file);
    resultBox.textContent = '';
  });

  analyzeBtn.addEventListener('click', analyzeImage);

  function mapPredictionToIdea(label){
    const L = (label||'').toLowerCase();
    const picks = [
     // {k:['bottle','plastic'], idea:'Turn into planters, bird feeders, eco‚Äëbricks; recycle in plastics bin.'},
     // {k:['can','tin','aluminum'], idea:'Rinse and recycle; upcycle as lanterns or pen holders.'},
     // {k:['paper','newspaper'], idea:'Recycle to pulp; make seed pots or papier‚Äëm√¢ch√©.'},
     // {k:['cardboard','carton','box'], idea:'Flatten & recycle; reuse as organizers; compost if plain.'},
     // {k:['glass','jar','bottle (glass)'], idea:'Reuse jars; recycle color‚Äësorted; make mosaic or lamps.'},
     // {k:['textile','t‚Äëshirt','fabric','cloth'], idea:'Make totes, rags, quilts; donate usable clothing.'},
     // {k:['battery','electronic','phone','laptop'], idea:'E‚Äëwaste: take to certified drop‚Äëoff; never bin it.'},
     // {k:['bag','film','wrapper'], idea:'Soft plastics: store and drop at designated collection points.'},
		
		//7 OctEdit
		// üß¥ PLASTICS
    {k:['plastic bottle','bottle'], idea:'Cut & paint bottles to grow herbs, make bird feeders, or eco-bricks. Recycle in plastics bin.'},
    {k:['bottle cap','cap'], idea:'Collect for art projects or drop off at plastic recycling centers.'},
    {k:['plastic bag','bag','polybag'], idea:'Soft plastic ‚Äî store and return to collection bins at supermarkets.'},
    {k:['food container','plastic container'], idea:'Wash, reuse for storage; if cracked, recycle as PP plastic.'},
    {k:['straw'], idea:'Avoid single-use; reuse for crafts or drop at soft plastic collection.'},
    {k:['plastic cup'], idea:'Reuse for seed starters or art; recycle clean ones only.'},
    {k:['plastic spoon','plastic fork','utensil'], idea:'Reuse or recycle if facility accepts; switch to metal/bamboo next time.'},
	// üìÑ PAPER & CARDBOARD
    {k:['paper','newspaper','sheet'], idea:'Recycle to pulp; use for crafts, papier-m√¢ch√©, or seed pots.'},
    {k:['cardboard','carton','box'], idea:'Flatten & recycle; reuse for organizers or compost if plain.'},
    {k:['book','booklet','brochure'], idea:'Donate usable books; recycle damaged ones as paper waste.'},
    // ü•´ METAL
    {k:['aluminum can','tin can','can'], idea:'Rinse and recycle; upcycle as lanterns or pen holders.'},
    {k:['foil','metal lid','wrapper'], idea:'Clean aluminum foil can be recycled; reuse foil for art or crafts.'},
	// üçæ GLASS
    {k:['glass bottle','glass jar','jar','glass'], idea:'Reuse jars for storage; recycle by color; craft into lamps or mosaics.'},
    {k:['broken glass'], idea:'Handle safely, wrap securely before recycling or disposal.'},
    // üíª E-WASTE
    {k:['battery'], idea:'Hazardous ‚Äî take to e-waste collection points; never bin it.'},
    {k:['mobile phone','cell phone','phone'], idea:'E-waste: donate or send to certified recyclers.'},
    {k:['laptop','computer'], idea:'Refurbish or donate if working; send to e-waste facility.'},
    {k:['charger','cable','wire'], idea:'Recycle as e-waste; avoid burning or throwing in bins.'},
    {k:['remote'], idea:'Remove batteries and recycle device as e-waste.'},
    // üåø ORGANIC
    {k:['fruit peel','banana peel','orange peel'], idea:'Add to compost; provides nutrients for plants.'},
    {k:['food waste','leftover','vegetable'], idea:'Compost organic food waste; avoid mixing with recyclables.'},
    {k:['eggshell'], idea:'Crush and use in compost or as calcium for plants.'},
    {k:['tea bag','coffee ground'], idea:'Compostable; excellent for soil enrichment.'},
 	// üëï TEXTILE
    {k:['t-shirt','shirt','jeans','cloth','fabric','textile'], idea:'Make tote bags, quilts, or donate usable clothes.'},
    {k:['shoe'], idea:'Clean pairs can be donated; damaged ones go to textile recycling.'},
    // ‚ò£Ô∏è NON-RECYCLABLE / HAZARDOUS
    {k:['styrofoam','foam'], idea:'Avoid use; not recyclable in most places.'},
    {k:['diaper'], idea:'Dispose in general waste; not recyclable.'},
    {k:['sanitary pad'], idea:'Wrap and discard in general waste; not recyclable.'},
    {k:['mask'], idea:'Single-use mask ‚Äî dispose safely in general waste.'},
	// ü™µ WOOD & FURNITURE
    {k:['wood','pallet','furniture','chopstick','pencil'], idea:'Reuse for crafts, shelves, or compost untreated wood. Avoid painted or laminated pieces.'},
    // üß± CONSTRUCTION & DEMOLITION
    {k:['brick','cement','tile','concrete'], idea:'Reuse for garden or construction fill. Send to building reuse center if available.'},
    {k:['metal rod','pipe','rebar'], idea:'Can be sold or recycled as scrap metal.'},
    // üîÅ RUBBER
    {k:['tyre','tire','rubber band','glove'], idea:'Upcycle as planters, mats, or donate to tire recycling facilities.'},
	 // üè• MEDICAL WASTE
    {k:['syringe','medicine','bandage','test kit'], idea:'Hazardous ‚Äî return to pharmacies or hospital disposal points.'},
    // üîã BATTERIES & LIGHT BULBS
    {k:['bulb','tube light','cfl','light'], idea:'Take to e-waste collection; contains mercury ‚Äî never throw in general waste.'},
    // üå≥ GARDEN WASTE
    {k:['leaf','branch','grass','plant'], idea:'Compost or turn into mulch; supports zero-waste gardening.'},
    // üõ¢Ô∏è COOKING OIL / GREASE
    {k:['oil','grease','butter'], idea:'Collect and recycle as biodiesel; never pour down sinks.'},
    // üì¶ COMPOSITE / MULTI-MATERIAL
    {k:['tetra pak','juice box','chips packet','laminated wrapper'], idea:'Drop at special collection points; can be recycled into boards.'},
 	// üß¥ HAZARDOUS HOUSEHOLD
    {k:['paint','bleach','spray','detergent'], idea:'Hazardous ‚Äî deliver to special chemical waste collection.'},
	 // üöó AUTOMOTIVE
    {k:['car part','engine oil','tire','battery (car)'], idea:'Take to car service centers for proper recycling.'},
    // üß∞ INDUSTRIAL WASTE
    {k:['factory scrap','machine part','metal scrap'], idea:'Recycle through industrial or metal recyclers.'},
    // üåä MARINE WASTE
    {k:['fishing net','rope','buoy'], idea:'Recycle through marine waste programs; avoid ocean dumping.'},
    // ‚öóÔ∏è LABORATORY WASTE
    {k:['chemical','vial','lab glass'], idea:'Hazardous; dispose only via licensed waste handlers.'},
    // üçΩÔ∏è CERAMIC & PORCELAIN
    {k:['ceramic','plate','tile','mug'], idea:'Reuse as garden edging or art; not recyclable curbside.'},
    // üõèÔ∏è FOAM & SPONGE
    {k:['sponge','mattress','cushion','foam seat'], idea:'Send to furniture recyclers or reuse stuffing.'},
    // üíø DISCS & MEDIA
    {k:['cd','dvd','disc'], idea:'Recycle via e-waste or creative reuse as decor.'},
    // üì¶ PACKAGING
    {k:['bubble wrap','packing peanuts','parcel'], idea:'Reuse or return to courier stores for recycling.'},
    // ‚ôªÔ∏è BIOPLASTICS
    {k:['bioplastic','compostable cup','pla'], idea:'Only compost in industrial facilities; not regular bins.'},
    // üî• ASH & DUST
    {k:['ash','dust'], idea:'Small amounts can go in compost; avoid large disposal.'},
    // üé® CREATIVE / DIY
    {k:['toy'], idea:'Repair, donate, or repurpose parts for crafts.'},
    {k:['crayon','brush','art','craft'], idea:'Use scraps for creative upcycling or decoration.'},
    {k:['decoration','bottle decoration'], idea:'Reuse materials creatively; inspire others to recycle through art.'}
 
    ];
    for(const p of picks){ if(p.k.some(w=>L.includes(w))) return p.idea; }
    return 'General tip: clean & sort materials; check local rules; prefer reuse or donation before recycling.';
  }

  async function analyzeImage(){
    resultBox.textContent = 'Analyzing image‚Ä¶';

    // 1) Ensure TF+model are ready
    try{ await modelLoadPromise; }catch(_){ /* handled in promise */ }
    if(!modelReady || !aiModel){
      resultBox.innerHTML = `<strong>Prediction:</strong> (model unavailable)<br/><strong>Idea:</strong> ${mapPredictionToIdea((imageInput.files?.[0]?.name)||'')}`;
      return;
    }

    // 2) Ensure an image is present & loaded
    if(!previewImg.src){
      resultBox.textContent = 'Please upload an image first.';
      return;
    }
    if(!previewImg.complete || previewImg.naturalWidth===0){
      await new Promise(res=>{ previewImg.onload=()=>res(); previewImg.onerror=()=>res(); });
    }

    // 3) Classify with TensorFlow MobileNet
    try{
      const preds = await aiModel.classify(previewImg);
      if(preds && preds.length){
        const top = preds[0];
        const idea = mapPredictionToIdea(top.className);
        resultBox.innerHTML = `<strong>Prediction:</strong> ${top.className} (${(top.probability*100).toFixed(1)}%)<br/><strong>Idea:</strong> ${idea}`;
      }else{
        resultBox.innerHTML = `<strong>Prediction:</strong> Unknown<br/><strong>Idea:</strong> ${mapPredictionToIdea('')}`;
      }
    }catch(err){
      console.error('AI Analysis Error:', err);
      statusEl.textContent = 'TensorFlow inference failed.';
      resultBox.innerHTML = `<strong>Prediction:</strong> (error)<br/><strong>Idea:</strong> ${mapPredictionToIdea((imageInput.files?.[0]?.name)||'')}`;
    }
  }

  /* -------------------- Lightweight Test Cases -------------------- 
  function runSuggestionTests(){
    const tests = [
      {label:'plastic bottle', expectNonEmpty:true},
      {label:'tin can', expectNonEmpty:true},
      {label:'cardboard box', expectNonEmpty:true},
      {label:'glass jar', expectNonEmpty:true},
      {label:'t‚Äëshirt fabric', expectNonEmpty:true},
      {label:'unknown thing', expectNonEmpty:true}
    ];
    const results = tests.map((t,i)=>{
      const out = mapPredictionToIdea(t.label);
      const pass = !!out && typeof out==='string' && out.length>5;
      return `Test ${i+1}: '${t.label}' ‚Üí ${pass?'PASS':'FAIL'}\n  Output: ${out}`;
    }).join('\n\n');
    diagEl.textContent = `TF backend: ${tf.getBackend?.()||'n/a'}\nModel ready: ${modelReady}\n${results}`;
  }
  // Kick tests after a short delay so TF can report backend
  setTimeout(runSuggestionTests, 600);*/
  
  
   // Recycle Center Map Logic
    const map = L.map('map').setView([5.3363, 100.2810], 13);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', { maxZoom: 19 }).addTo(map);

    const geocoder = L.Control.Geocoder.nominatim();
    L.Control.geocoder({ geocoder }).addTo(map);

    let markers = [];

    function updateRecycleCenters(lat, lon) {
      fetch(`https://overpass-api.de/api/interpreter?data=[out:json];node["amenity"="recycling"](around:5000,${lat},${lon});out;`)
        .then(res => res.json())
        .then(data => {
          markers.forEach(m => map.removeLayer(m));
          markers = [];

          let centers = data.elements.map(el => {
            const distance = map.distance([lat, lon], [el.lat, el.lon]) / 1000;

			// Try multiple fields for name and address
        	const name = el.tags.name 
                  || el.tags.operator 
                  || el.tags.brand 
                  || el.tags.description 
                  || 'Recycling Center';

        	const address = el.tags['addr:street'] 
                     || el.tags['addr:full'] 
                     || el.tags['addr:place']
                     || el.tags['addr:city']
                     || el.tags.description
                     || el.tags.operator
                     || 'Address not found';
          //  return { name: el.tags.name || 'Recycling Center', lat: el.lat, lon: el.lon, distance: distance.toFixed(2), address: el.tags['addr:street'] || 'Address not available' };
         // });
			return { name, lat: el.lat, lon: el.lon, distance: distance.toFixed(2), address };
          });
          centers.sort((a, b) => a.distance - b.distance);
          centers = centers.slice(0, 10);

          const list = document.getElementById('centerList');
          list.innerHTML = '';

          centers.forEach(center => {
            const marker = L.marker([center.lat, center.lon]).addTo(map)
              .bindPopup(`<b>${center.name}</b><br>${center.address}<br>${center.distance} km<br><a href=\"https://www.google.com/maps/dir/?api=1&destination=${center.lat},${center.lon}\" target=\"_blank\">Get Directions</a>`);
            markers.push(marker);

            const li = document.createElement('li');
            li.innerHTML = `<div class=\"center-info\"><span class=\"icon\">‚ôªÔ∏è</span><span>${center.name}</span><span class=\"badge\">${center.distance} km</span></div>`;
            li.onclick = () => {
              map.setView([center.lat, center.lon], 16);
              marker.openPopup();
            };
            list.appendChild(li);
          });
        })
        .catch(err => console.error('Error fetching recycle centers:', err));
    }

    if (navigator.geolocation) {
      navigator.geolocation.getCurrentPosition(pos => {
        const { latitude, longitude } = pos.coords;
        map.setView([latitude, longitude], 14);
        updateRecycleCenters(latitude, longitude);
      }, () => {
        updateRecycleCenters(5.3363, 100.2810);
      });
    } else {
      updateRecycleCenters(5.3363, 100.2810);
    }

    map.on('moveend', () => {
      const center = map.getCenter();
      updateRecycleCenters(center.lat, center.lng);
    });



	// =================== QUIZ LOGIC ===================
const quizData = [
  {
    q: "What does the recycling symbol ‚ôªÔ∏è represent?",
    options: ["Reduce, Reuse, Recycle", "Only Recycling", "Trash", "Composting"],
    answer: 0,
    explanation: "‚ôªÔ∏è stands for the 3Rs: Reduce, Reuse, and Recycle."
  },
  {
    q: "Which of these materials is usually NOT recyclable?",
    options: ["Glass bottles", "Plastic bags", "Aluminum cans", "Cardboard"],
    answer: 1,
    explanation: "Plastic bags often clog machines and require special collection programs."
  },
  {
    q: "How long does it take for plastic bottles to decompose?",
    options: ["50 years", "100 years", "450 years", "10 years"],
    answer: 2,
    explanation: "Plastic bottles take about 450 years to decompose."
  },
  {
    q: "Which SDG (Sustainable Development Goal) focuses on Responsible Consumption and Production?",
    options: ["SDG 7", "SDG 12", "SDG 5", "SDG 15"],
    answer: 1,
    explanation: "SDG 12 is about Responsible Consumption and Production."
  },
  {
    q: "Which of the following is the best way to reduce waste?",
    options: ["Reuse items", "Recycle everything", "Burn waste", "Throw away items"],
    answer: 0,
    explanation: "Reusing is even better than recycling since it avoids producing new waste."
  },
  {
    q: "What color bin is usually used for recycling paper?",
    options: ["Green", "Blue", "Yellow", "Red"],
    answer: 1,
    explanation: "Blue bins are often used for paper recycling."
  },
  {
    q: "E-waste refers to:",
    options: ["Electronic waste", "Energy waste", "Edible waste", "Emergency waste"],
    answer: 0,
    explanation: "E-waste stands for discarded electronic devices like phones and computers."
  },
  {
    q: "Composting is best for:",
    options: ["Metal cans", "Food scraps", "Plastic bottles", "Glass jars"],
    answer: 1,
    explanation: "Food scraps can be composted to make natural fertilizer."
  },
  // üëâ Add more questions here to reach 20+ in the pool
{
    q: "What is the main goal of recycling?",
    options: ["To reduce pollution", "To produce more waste", "To use more resources", "To fill landfills"],
    answer: 0,
    explanation: "Recycling helps reduce pollution and conserve natural resources."
  },
  {
    q: "Which type of energy is produced from waste in waste-to-energy plants?",
    options: ["Nuclear energy", "Solar energy", "Electricity or heat", "Wind energy"],
    answer: 2,
    explanation: "Waste-to-energy plants convert waste materials into electricity or heat."
  },
  {
    q: "Which material can be recycled indefinitely without losing quality?",
    options: ["Plastic", "Glass", "Paper", "Wood"],
    answer: 1,
    explanation: "Glass can be recycled endlessly without losing purity or quality."
  },
  {
    q: "Which of these helps reduce plastic pollution the most?",
    options: ["Using reusable bottles", "Buying more plastic", "Burning plastic", "Throwing plastic away"],
    answer: 0,
    explanation: "Using reusable bottles cuts down the need for single-use plastics."
  },
  {
    q: "Which bin should metal cans go into?",
    options: ["Green", "Yellow", "Blue", "Red"],
    answer: 1,
    explanation: "Yellow bins are typically used for metal and plastic recyclables."
  },
  {
    q: "What happens to waste that is not recycled?",
    options: ["It disappears", "It turns into soil", "It ends up in landfills or the ocean", "It becomes compost"],
    answer: 2,
    explanation: "Unrecycled waste often ends up in landfills or pollutes the ocean."
  },
  {
    q: "Which of the following is biodegradable?",
    options: ["Banana peel", "Plastic cup", "Glass bottle", "Aluminum can"],
    answer: 0,
    explanation: "Banana peels are organic and decompose naturally."
  },
  {
    q: "What does 'upcycling' mean?",
    options: ["Turning waste into something of higher value", "Throwing away old items", "Downcycling materials", "Burning waste for energy"],
    answer: 0,
    explanation: "Upcycling creatively reuses materials to create higher-value products."
  },
  {
    q: "Which of the following actions saves the most energy?",
    options: ["Recycling aluminum cans", "Recycling paper", "Recycling glass", "Recycling plastic"],
    answer: 0,
    explanation: "Recycling aluminum saves up to 95% of the energy compared to producing new aluminum."
  },
  {
    q: "Which country is known for having one of the highest recycling rates in the world?",
    options: ["Germany", "Malaysia", "India", "USA"],
    answer: 0,
    explanation: "Germany consistently leads global recycling rankings."
  },
  {
    q: "Why is it important to rinse containers before recycling?",
    options: ["To reduce contamination", "To make them shiny", "To make them lighter", "It‚Äôs not necessary"],
    answer: 0,
    explanation: "Rinsing prevents contamination that can spoil an entire batch of recyclables."
  },
  {
    q: "What is the main purpose of the 3R campaign?",
    options: ["To reduce waste generation", "To promote more consumption", "To increase landfill size", "To encourage waste burning"],
    answer: 0,
    explanation: "The 3R campaign (Reduce, Reuse, Recycle) aims to minimize waste and protect the environment."
  }
	
];

let quizQuestions = [];
let currentQ = 0;
let score = 0;

const quizContainer = document.getElementById("quiz-container");

function startQuiz() {
  // Pick 5 random questions
  quizQuestions = quizData.sort(() => 0.5 - Math.random()).slice(0, 5);
  currentQ = 0;
  score = 0;
  showQuestion();
}

function showQuestion() {
  if (currentQ >= quizQuestions.length) {
    showResult();
    return;
  }

  const q = quizQuestions[currentQ];
  quizContainer.innerHTML = `
    <p><strong>Question ${currentQ + 1} of ${quizQuestions.length}</strong></p>
    <h3>${q.q}</h3>
    <div id="options"></div>
  `;

  const optionsDiv = document.getElementById("options");
  q.options.forEach((opt, i) => {
    const btn = document.createElement("button");
    btn.className = "btn";
    btn.style.display = "block";
    btn.style.margin = "6px 0";
    btn.textContent = opt;
    btn.onclick = () => checkAnswer(i);
    optionsDiv.appendChild(btn);
  });
}

function checkAnswer(choice) {
  const q = quizQuestions[currentQ];
  let feedback = "";
  if (choice === q.answer) {
    score++;
    feedback = `<p style="color:green"><strong>‚úÖ Correct!</strong> ${q.explanation}</p>`;
  } else {
    feedback = `<p style="color:red"><strong>‚ùå Incorrect.</strong> ${q.explanation}</p>`;
  }

  quizContainer.innerHTML += feedback;

  setTimeout(() => {
    currentQ++;
    showQuestion();
  }, 2000);
}

function showResult() {
  quizContainer.innerHTML = `
    <h3>Quiz Completed üéâ</h3>
    <p>Your Score: ${score}/${quizQuestions.length}</p>
    <button class="btn" onclick="startQuiz()">Restart Quiz</button>
  `;
}

document.getElementById("startQuiz").addEventListener("click", startQuiz);



// =================== SORTING GAME ===================
const gameItems = [
  { icon: "üçé", name: "Apple Core", type: "organic" },
  { icon: "üçå", name: "Banana Peel", type: "organic" },
  { icon: "ü•¶", name: "Vegetable Scraps", type: "organic" },
  { icon: "ü•ö", name: "Eggshells", type: "organic" },
  { icon: "üì∞", name: "Newspaper", type: "paper" },
  { icon: "üì¶", name: "Cardboard Box", type: "paper" },
  { icon: "üìÑ", name: "Office Paper", type: "paper" },
  { icon: "üìö", name: "Old Book", type: "paper" },
  { icon: "ü•§", name: "Plastic Bottle", type: "plastic" },
  { icon: "üõçÔ∏è", name: "Plastic Bag", type: "plastic" },
  { icon: "üç∂", name: "Plastic Container", type: "plastic" },
  { icon: "üß¥", name: "Shampoo Bottle", type: "plastic" },
  { icon: "ü™ô", name: "Soda Can", type: "metal" },
  { icon: "ü•´", name: "Tin Can", type: "metal" },
  { icon: "üîã", name: "Used Battery", type: "metal" },
  { icon: "üõ†Ô∏è", name: "Metal Tool", type: "metal" },
  { icon: "üç∑", name: "Glass Bottle", type: "general" },
  { icon: "ü•õ", name: "Milk Carton", type: "general" },
  { icon: "‚òï", name: "Coffee Cup", type: "general" },
  { icon: "üí°", name: "Light Bulb", type: "general" },
  { icon: "üíª", name: "Old Laptop", type: "general" }
];


const bins = [
  { id: "organic", label: "üçé Organic" },
  { id: "paper", label: "üì∞ Paper" },
  { id: "plastic", label: "‚ôªÔ∏è Plastic" },
  { id: "metal", label: "ü™ô Metal" },
  { id: "general", label: "üóëÔ∏è General Waste" }
];

let gamescore = 0;
let wrongAttempts = 0;
const scoreEl = document.getElementById("game-score");
const itemsDiv = document.getElementById("items");
const binsDiv = document.getElementById("bins");

// Render items
function renderGame() {
  gamescore = 0;
  wrongAttempts = 0;
  scoreEl.textContent = "Score: 0 | Wrong Attempts: 0";
  itemsDiv.innerHTML = "";
  binsDiv.innerHTML = "";

  // Pick 5 random items from the pool
  const shuffledItems = [...gameItems].sort(() => Math.random() - 0.5).slice(0, 5);

  shuffledItems.forEach((item, i) => {
    const div = document.createElement("div");
    div.className = "item";
    div.draggable = true;
    div.id = "item-" + i;
    div.dataset.type = item.type;
    div.textContent = item.icon + " " + item.name;
    div.addEventListener("dragstart", dragStart);
    itemsDiv.appendChild(div);
  });

  bins.forEach(bin => {
    const div = document.createElement("div");
    div.className = "bin";
    div.id = bin.id;
    div.textContent = bin.label;
    div.addEventListener("dragover", dragOver);
    div.addEventListener("drop", dropItem);
    binsDiv.appendChild(div);
  });

  // Save the current game set for win check
  window.currentGameItems = shuffledItems;
}


function dragStart(e) {
  e.dataTransfer.setData("text", e.target.id);
}

function dragOver(e) {
  e.preventDefault();
}

function dropItem(e) {
  e.preventDefault();
  const itemId = e.dataTransfer.getData("text");
  const itemEl = document.getElementById(itemId);
  if (!itemEl) return;

  const itemType = itemEl.dataset.type;
  const binType = e.currentTarget.id;

  if (itemType === binType) {
    e.currentTarget.classList.add("correct");
    setTimeout(() => e.currentTarget.classList.remove("correct"), 800);
    itemEl.remove();
    gamescore++;
    scoreEl.textContent = `Score: ${gamescore} | Wrong Attempts: ${wrongAttempts}`;

    if (gamescore === window.currentGameItems.length) {
      scoreEl.innerHTML = `
        üéâ You sorted items correctly!<br>
        ‚úÖ Final Score: ${gamescore}<br>
        ‚ùå Wrong Attempts: ${wrongAttempts}<br>
        <button class='btn' onclick='renderGame()'>Play Again</button>
      `;
    }
  } else {
    wrongAttempts++;
    scoreEl.textContent = `Score: ${gamescore} | Wrong Attempts: ${wrongAttempts}`;
    e.currentTarget.classList.add("wrong");
    setTimeout(() => e.currentTarget.classList.remove("wrong"), 800);
  }
}


renderGame();


  </script>
</body>
</html>
